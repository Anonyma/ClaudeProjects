<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Learning Lab — Dynamic Modules</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@500;700&family=Space+Grotesk:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0f1115;
      --surface: #151922;
      --surface-2: #1c2230;
      --ink: #f4f4f2;
      --muted: #9aa0ac;
      --accent: #ffb347;
      --accent-2: #7bdff2;
      --accent-3: #b8f2e6;
      --border: rgba(244, 244, 242, 0.08);
      --shadow: 0 22px 60px rgba(0, 0, 0, 0.45);
      --radius: 18px;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: radial-gradient(circle at 15% 20%, rgba(123, 223, 242, 0.2), transparent 40%),
                  radial-gradient(circle at 70% 20%, rgba(255, 179, 71, 0.15), transparent 45%),
                  var(--bg);
      color: var(--ink);
      font-family: "Space Grotesk", sans-serif;
    }

    .wrap {
      max-width: 1200px;
      margin: 0 auto;
      padding: 32px 24px 72px;
    }

    header {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 18px;
      justify-content: space-between;
      margin-bottom: 28px;
    }

    h1 {
      font-family: "Fraunces", serif;
      font-size: clamp(2rem, 3vw, 3rem);
      margin: 0;
    }

    .subtitle {
      color: var(--muted);
      max-width: 520px;
      font-size: 0.98rem;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
    }

    .panel {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.02), transparent 60%),
                  var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 18px;
      box-shadow: var(--shadow);
      min-height: 260px;
      position: relative;
      overflow: hidden;
    }

    .panel h2 {
      margin: 0 0 8px;
      font-size: 1.05rem;
    }

    .panel p {
      margin: 0 0 12px;
      color: var(--muted);
      font-size: 0.9rem;
    }

    .orbit {
      position: relative;
      height: 220px;
      margin-top: 10px;
    }

    .orbit-ring {
      position: absolute;
      inset: 10% 18% 10% 18%;
      border: 1px dashed rgba(123, 223, 242, 0.4);
      border-radius: 50%;
    }

    .orbit-ring.r2 {
      inset: 22% 30% 22% 30%;
      border-color: rgba(255, 179, 71, 0.4);
    }

    .orbit-event {
      position: absolute;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--accent-2);
      box-shadow: 0 0 12px rgba(123, 223, 242, 0.8);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .orbit-event:hover {
      transform: scale(1.3);
    }

    .orbit-card {
      position: absolute;
      right: 10px;
      bottom: 10px;
      background: var(--surface-2);
      border-radius: 12px;
      padding: 10px 12px;
      font-size: 0.8rem;
      color: var(--muted);
      border: 1px solid var(--border);
    }

    .orbit-title {
      font-weight: 600;
      color: var(--ink);
      margin-bottom: 4px;
    }

    .orbit-detail {
      font-size: 0.75rem;
      color: var(--muted);
      line-height: 1.4;
    }

    .slider-wrap {
      margin-top: 12px;
    }

    input[type="range"] {
      width: 100%;
      accent-color: var(--accent);
    }

    .scenario-legend {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      font-size: 0.7rem;
      color: var(--muted);
      margin-top: 6px;
    }

    .scenario-legend span::before {
      content: "";
      display: inline-block;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      margin-right: 6px;
      background: currentColor;
    }

    .legend-displacement {
      color: var(--accent);
    }

    .legend-productivity {
      color: var(--accent-2);
    }

    .split-lens {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .lens-card {
      background: var(--surface-2);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px;
      min-height: 140px;
      transition: transform 0.2s ease, border 0.2s ease, box-shadow 0.2s ease;
    }

    .lens-card h3 {
      margin: 0 0 8px;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--accent-2);
    }

    .lens-card.active {
      border-color: rgba(123, 223, 242, 0.6);
      box-shadow: 0 0 24px rgba(123, 223, 242, 0.25);
      transform: translateY(-2px);
    }

    .lens-body {
      font-size: 0.85rem;
      color: var(--muted);
      margin-bottom: 10px;
    }

    .lens-metrics {
      display: grid;
      gap: 8px;
      font-size: 0.7rem;
      color: var(--muted);
    }

    .metric-row {
      display: grid;
      grid-template-columns: 80px 1fr;
      gap: 8px;
      align-items: center;
    }

    .metric-bar {
      height: 6px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.1);
      overflow: hidden;
    }

    .metric-bar span {
      display: block;
      height: 100%;
      border-radius: inherit;
      background: linear-gradient(90deg, var(--accent-2), var(--accent));
    }

    .contrast-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 10px;
    }

    .contrast-chip {
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: transparent;
      color: var(--muted);
      font-size: 0.72rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      cursor: pointer;
    }

    .contrast-chip.active {
      border-color: var(--accent);
      color: var(--accent);
      background: rgba(255, 179, 71, 0.1);
    }

    .accordion {
      display: grid;
      gap: 8px;
    }

    .accordion button {
      width: 100%;
      text-align: left;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--surface-2);
      color: var(--ink);
      cursor: pointer;
    }

    .accordion .content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      background: rgba(123, 223, 242, 0.08);
      border-radius: 12px;
      padding: 0 12px;
      color: var(--muted);
    }

    .accordion .content.open {
      max-height: 120px;
      padding: 10px 12px;
    }

    .artifact-carousel {
      display: grid;
      grid-auto-flow: column;
      grid-auto-columns: minmax(160px, 1fr);
      gap: 10px;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      padding-bottom: 6px;
    }

    .artifact-card {
      scroll-snap-align: start;
      border-radius: 14px;
      padding: 10px;
      background: var(--surface-2);
      border: 1px solid var(--border);
      min-height: 140px;
      cursor: pointer;
      transition: transform 0.2s ease, border 0.2s ease;
    }

    .artifact-card:hover {
      transform: translateY(-3px);
      border-color: rgba(255, 179, 71, 0.5);
    }

    .artifact-thumb {
      height: 70px;
      border-radius: 12px;
      background: linear-gradient(135deg, rgba(255, 179, 71, 0.25), rgba(123, 223, 242, 0.25));
      margin-bottom: 8px;
    }

    .artifact-title {
      font-size: 0.8rem;
      font-weight: 600;
    }

    .artifact-note {
      margin-top: 10px;
      font-size: 0.8rem;
      color: var(--muted);
    }

    .heatmap-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 6px;
      margin-top: 10px;
    }

    .heatmap-cell {
      border-radius: 8px;
      padding: 8px;
      font-size: 0.7rem;
      text-align: center;
      color: var(--ink);
      background: rgba(123, 223, 242, 0.2);
    }

    .heatmap-cell.high { background: rgba(123, 223, 242, 0.35); }
    .heatmap-cell.mid { background: rgba(255, 179, 71, 0.25); }
    .heatmap-cell.low { background: rgba(255, 255, 255, 0.06); }

    .concept-matrix {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
      margin-top: 12px;
    }

    .matrix-cell {
      background: var(--surface-2);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px;
      min-height: 72px;
      font-size: 0.78rem;
      color: var(--muted);
      cursor: pointer;
      transition: border 0.2s ease, color 0.2s ease;
    }

    .matrix-cell.active {
      border-color: rgba(123, 223, 242, 0.6);
      color: var(--ink);
    }

    .matrix-detail {
      margin-top: 10px;
      font-size: 0.8rem;
      color: var(--muted);
    }

    .orbit-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 8px;
      font-size: 0.78rem;
      color: var(--muted);
    }

    .orbit-chip {
      padding: 6px 10px;
      border-radius: 10px;
      border: 1px solid var(--border);
      cursor: pointer;
      background: rgba(255, 255, 255, 0.02);
    }

    .orbit-chip.active {
      border-color: var(--accent-2);
      color: var(--accent-2);
    }

    .scenario-note {
      margin-top: 10px;
      font-size: 0.85rem;
      color: var(--muted);
    }

    @media (max-width: 900px) {
      .split-lens {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Learning Lab — Dynamic Modules</h1>
        <div class="subtitle">A darker, more cinematic visual language with interactive modules designed for quick comprehension and exploration.</div>
      </div>
      <div class="subtitle">Prototype only — pick what feels right, then we’ll integrate.</div>
    </header>

    <div class="grid">
      <section class="panel">
        <h2>Constellation Graph</h2>
        <p>WebGL graph with subtle glow + clustering. Hover nodes to highlight a concept cluster.</p>
        <div id="sigma" style="height:200px;"></div>
      </section>

      <section class="panel">
        <h2>Orbit Timeline</h2>
        <p>Key turning points mapped onto orbital rings. Click nodes to update the detail card.</p>
        <div class="orbit" id="orbit">
          <div class="orbit-ring"></div>
          <div class="orbit-ring r2"></div>
          <div class="orbit-card" id="orbit-card">
            <div class="orbit-title" id="orbit-title">1997 — Guggenheim Bilbao</div>
            <div class="orbit-detail" id="orbit-detail">Iconic form making + tourism-led urban revival.</div>
          </div>
        </div>
        <div class="orbit-list" id="orbit-list">
          <div class="orbit-chip" data-label="1988 — MoMA Deconstructivism" data-detail="Fractured geometries challenge modernist order.">1988 — MoMA Deconstructivism</div>
          <div class="orbit-chip active" data-label="1997 — Guggenheim Bilbao" data-detail="Iconic form making + tourism-led urban revival.">1997 — Guggenheim Bilbao</div>
          <div class="orbit-chip" data-label="2008 — Parametricism Manifesto" data-detail="Computational workflows become a movement.">2008 — Parametricism Manifesto</div>
          <div class="orbit-chip" data-label="2013 — Living Building Challenge" data-detail="Regenerative targets shift sustainability.">2013 — Living Building Challenge</div>
          <div class="orbit-chip" data-label="2017 — Mass Timber Surge" data-detail="CLT unlocks mid-rise carbon reductions.">2017 — Mass Timber Surge</div>
        </div>
      </section>

      <section class="panel">
        <h2>Scenario Slider</h2>
        <p>Drag to see how automation intensity reshapes the learning summary.</p>
        <canvas id="scenario-canvas" height="140" style="width:100%;"></canvas>
        <div class="slider-wrap">
          <input id="scenario-slider" type="range" min="0" max="100" value="42" />
        </div>
        <div class="scenario-legend">
          <span class="legend-displacement">Displacement</span>
          <span class="legend-productivity">Productivity</span>
        </div>
        <div class="scenario-note" id="scenario-note">Moderate displacement, steady productivity gains, mixed policy pressure.</div>
      </section>

      <section class="panel">
        <h2>Split Lens Compare</h2>
        <p>Toggle the lens to shift the contrast emphasis.</p>
        <div class="contrast-controls" id="contrast-controls">
          <button class="contrast-chip active" data-lens="aesthetic">Aesthetic</button>
          <button class="contrast-chip" data-lens="politics">Politics</button>
          <button class="contrast-chip" data-lens="material">Material</button>
        </div>
        <div class="split-lens">
          <div class="lens-card active" id="lens-left">
            <h3>Rococo</h3>
            <div class="lens-body">Pastel palette, intimacy, ornamental lightness, private pleasure.</div>
            <div class="lens-metrics" id="lens-left-metrics"></div>
          </div>
          <div class="lens-card" id="lens-right">
            <h3>Brutalism</h3>
            <div class="lens-body">Raw structure, moral clarity, collective function, heavy mass.</div>
            <div class="lens-metrics" id="lens-right-metrics"></div>
          </div>
        </div>
      </section>

      <section class="panel">
        <h2>Evidence Stack</h2>
        <p>Click to unfold claims + sources without leaving the page.</p>
        <div class="accordion">
          <button data-acc="1">Claim: Parametricism responds to urban flows</button>
          <div class="content" id="acc-1">MAXXI, ZHA masterplans, and flow-based circulation studies support this claim.</div>
          <button data-acc="2">Claim: Mass timber reduces embodied carbon</button>
          <div class="content" id="acc-2">Brock Commons, Mjostarnet, and CLT lifecycle studies show large carbon reductions.</div>
          <button data-acc="3">Claim: Kinetic facades reduce heat gain</button>
          <div class="content" id="acc-3">Al Bahar Towers report ~50% solar gain reduction via responsive mashrabiya.</div>
        </div>
      </section>

      <section class="panel">
        <h2>Story Heatmap</h2>
        <p>Micro heatmap to show which sections learners revisit most.</p>
        <div class="heatmap-grid">
          <div class="heatmap-cell high">Intro</div>
          <div class="heatmap-cell mid">Core</div>
          <div class="heatmap-cell low">Cases</div>
          <div class="heatmap-cell mid">Wrap</div>
          <div class="heatmap-cell low">Week 1</div>
          <div class="heatmap-cell high">Week 2</div>
          <div class="heatmap-cell mid">Week 3</div>
          <div class="heatmap-cell low">Week 4</div>
        </div>
      </section>

      <section class="panel">
        <h2>Artifact Carousel</h2>
        <p>Swipe through iconic objects; tap to reveal the key annotation.</p>
        <div class="artifact-carousel" id="artifact-carousel">
          <div class="artifact-card" data-note="Poster graphics codify the Vienna Secession identity.">
            <div class="artifact-thumb"></div>
            <div class="artifact-title">Secession Poster</div>
          </div>
          <div class="artifact-card" data-note="Whiplash motifs turn everyday objects into art.">
            <div class="artifact-thumb"></div>
            <div class="artifact-title">Art Nouveau Lamp</div>
          </div>
          <div class="artifact-card" data-note="Parametric grids move from sketch to fabrication.">
            <div class="artifact-thumb"></div>
            <div class="artifact-title">Computational Facade</div>
          </div>
          <div class="artifact-card" data-note="Mass timber joints reduce embodied carbon.">
            <div class="artifact-thumb"></div>
            <div class="artifact-title">CLT Detail</div>
          </div>
        </div>
        <div class="artifact-note" id="artifact-note">Poster graphics codify the Vienna Secession identity.</div>
      </section>

      <section class="panel">
        <h2>Concept Matrix</h2>
        <p>Plot ideas across axes to compare tone, politics, and material logic.</p>
        <div class="concept-matrix" id="concept-matrix">
          <div class="matrix-cell active" data-detail="Ornament + private luxury: Rococo interiors, salon culture, soft authority.">Ornament + Private</div>
          <div class="matrix-cell" data-detail="Ornament + public spectacle: Secession exhibitions and civic pageantry.">Ornament + Public</div>
          <div class="matrix-cell" data-detail="Austere + public: Brutalist civic housing and collective infrastructures.">Austere + Public</div>
          <div class="matrix-cell" data-detail="Austere + private: Minimalist domestic calm, engineered restraint.">Austere + Private</div>
        </div>
        <div class="matrix-detail" id="matrix-detail">Ornament + private luxury: Rococo interiors, salon culture, soft authority.</div>
      </section>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/graphology@0.25.1/dist/graphology.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sigma@2.4.0/build/sigma.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      if (window.graphology && window.sigma) {
        const Graph = graphology.Graph;
        const graph = new Graph();
        const nodes = [
          { id: 'param', label: 'Parametricism', x: 0, y: 0, size: 12, color: '#7bdff2' },
          { id: 'bio', label: 'Biomimicry', x: 1, y: 1, size: 10, color: '#b8f2e6' },
          { id: 'timber', label: 'Mass Timber', x: -1, y: 1, size: 10, color: '#ffb347' },
          { id: 'ai', label: 'AI Tools', x: 1, y: -1, size: 8, color: '#f4978e' },
          { id: 'kinetic', label: 'Kinetic Facades', x: -1, y: -1, size: 8, color: '#ffd6a5' },
        ];
        nodes.forEach(node => graph.addNode(node.id, node));
        graph.addEdge('param', 'bio');
        graph.addEdge('param', 'ai');
        graph.addEdge('bio', 'timber');
        graph.addEdge('timber', 'kinetic');

        new sigma.Sigma(graph, document.getElementById('sigma'), {
          defaultEdgeColor: 'rgba(255,255,255,0.25)',
          defaultNodeColor: '#7bdff2',
          renderLabels: true,
          labelFont: 'Space Grotesk',
          labelColor: { color: '#f4f4f2' },
        });
      } else {
        document.getElementById('sigma').textContent = 'Graph unavailable (library not loaded).';
      }

      const orbitEvents = [
        { label: '1988 — MoMA Deconstructivism', detail: 'Fractured geometries challenge modernist order.', x: '18%', y: '18%' },
        { label: '1997 — Guggenheim Bilbao', detail: 'Iconic form making + tourism-led urban revival.', x: '76%', y: '28%' },
        { label: '2008 — Parametricism Manifesto', detail: 'Computational workflows become a movement.', x: '30%', y: '78%' },
        { label: '2013 — Living Building Challenge', detail: 'Regenerative targets shift sustainability.', x: '50%', y: '50%' },
        { label: '2017 — Mass Timber Surge', detail: 'CLT unlocks mid-rise carbon reductions.', x: '70%', y: '70%' },
      ];
      const orbit = document.getElementById('orbit');
      const cardTitle = document.getElementById('orbit-title');
      const cardDetail = document.getElementById('orbit-detail');
      const setOrbitCard = (event) => {
        cardTitle.textContent = event.label;
        cardDetail.textContent = event.detail;
      };
      orbitEvents.forEach(event => {
        const dot = document.createElement('div');
        dot.className = 'orbit-event';
        dot.style.left = event.x;
        dot.style.top = event.y;
        dot.addEventListener('mouseenter', () => { setOrbitCard(event); });
        dot.addEventListener('click', () => { setOrbitCard(event); });
        orbit.appendChild(dot);
      });

      document.querySelectorAll('.orbit-chip').forEach(chip => {
        chip.addEventListener('click', () => {
          document.querySelectorAll('.orbit-chip').forEach(c => c.classList.remove('active'));
          chip.classList.add('active');
          setOrbitCard({ label: chip.dataset.label, detail: chip.dataset.detail });
        });
      });

      const lensData = {
        aesthetic: {
          left: 'Pastel palette, intimacy, ornamental lightness, private pleasure.',
          right: 'Raw structure, moral clarity, collective function, heavy mass.',
          metrics: [
            { label: 'Ornament', left: 88, right: 22 },
            { label: 'Lightness', left: 75, right: 30 },
            { label: 'Expression', left: 68, right: 40 },
          ],
        },
        politics: {
          left: 'Signals aristocratic leisure and private privilege.',
          right: 'Signals collective infrastructure and state power.',
          metrics: [
            { label: 'Hierarchy', left: 78, right: 35 },
            { label: 'Collective', left: 20, right: 85 },
            { label: 'Control', left: 42, right: 70 },
          ],
        },
        material: {
          left: 'Gilded surfaces, carved ornament, delicate craft.',
          right: 'Raw concrete, modular repetition, industrial scale.',
          metrics: [
            { label: 'Surface', left: 86, right: 28 },
            { label: 'Mass', left: 25, right: 90 },
            { label: 'Craft', left: 70, right: 38 },
          ],
        },
      };

      const lensLeft = document.getElementById('lens-left');
      const lensRight = document.getElementById('lens-right');
      const lensLeftMetrics = document.getElementById('lens-left-metrics');
      const lensRightMetrics = document.getElementById('lens-right-metrics');
      const renderMetrics = (lens) => {
        const metrics = lensData[lens].metrics;
        lensLeftMetrics.innerHTML = metrics.map(metric => (
          `<div class="metric-row"><div>${metric.label}</div><div class="metric-bar"><span style="width:${metric.left}%"></span></div></div>`
        )).join('');
        lensRightMetrics.innerHTML = metrics.map(metric => (
          `<div class="metric-row"><div>${metric.label}</div><div class="metric-bar"><span style="width:${metric.right}%"></span></div></div>`
        )).join('');
      };
      renderMetrics('aesthetic');
      document.getElementById('contrast-controls').addEventListener('click', (e) => {
        const target = e.target.closest('.contrast-chip');
        if (!target) return;
        document.querySelectorAll('.contrast-chip').forEach(chip => chip.classList.remove('active'));
        target.classList.add('active');
        const lens = target.dataset.lens;
        lensLeft.classList.add('active');
        lensRight.classList.add('active');
        lensLeft.querySelector('.lens-body').textContent = lensData[lens].left;
        lensRight.querySelector('.lens-body').textContent = lensData[lens].right;
        renderMetrics(lens);
      });

      document.querySelectorAll('.accordion button').forEach(btn => {
        btn.addEventListener('click', () => {
          const content = document.getElementById(`acc-${btn.dataset.acc}`);
          content.classList.toggle('open');
        });
      });

      const scenarioNote = document.getElementById('scenario-note');
      const scenarioCanvas = document.getElementById('scenario-canvas');
      const scenarioCtx = scenarioCanvas.getContext('2d');
      const scenarioHeight = scenarioCanvas.height;
      const resizeScenario = () => {
        const dpr = window.devicePixelRatio || 1;
        const displayWidth = scenarioCanvas.clientWidth;
        const displayHeight = scenarioHeight;
        scenarioCanvas.width = displayWidth * dpr;
        scenarioCanvas.height = displayHeight * dpr;
        scenarioCtx.setTransform(dpr, 0, 0, dpr, 0, 0);
      };
      const drawScenario = (value) => {
        const width = scenarioCanvas.clientWidth;
        const height = scenarioHeight;
        scenarioCtx.clearRect(0, 0, width, height);
        scenarioCtx.strokeStyle = 'rgba(244,244,242,0.1)';
        scenarioCtx.beginPath();
        scenarioCtx.moveTo(0, height - 24);
        scenarioCtx.lineTo(width, height - 24);
        scenarioCtx.stroke();

        const displacement = value;
        const productivity = Math.min(100, 30 + value * 0.6);
        const xStep = width / 4;
        const points = [0, value * 0.4, value * 0.7, displacement];

        scenarioCtx.strokeStyle = '#ffb347';
        scenarioCtx.lineWidth = 2;
        scenarioCtx.beginPath();
        points.forEach((point, index) => {
          const x = index * xStep;
          const y = height - 24 - (point / 100) * (height - 40);
          if (index === 0) {
            scenarioCtx.moveTo(x, y);
          } else {
            scenarioCtx.lineTo(x, y);
          }
        });
        scenarioCtx.stroke();

        scenarioCtx.strokeStyle = '#7bdff2';
        scenarioCtx.beginPath();
        const prodPoints = [20, productivity * 0.5, productivity * 0.8, productivity];
        prodPoints.forEach((point, index) => {
          const x = index * xStep;
          const y = height - 24 - (point / 100) * (height - 40);
          if (index === 0) {
            scenarioCtx.moveTo(x, y);
          } else {
            scenarioCtx.lineTo(x, y);
          }
        });
        scenarioCtx.stroke();
      };
      resizeScenario();
      drawScenario(Number(document.getElementById('scenario-slider').value));
      window.addEventListener('resize', () => {
        resizeScenario();
        drawScenario(Number(document.getElementById('scenario-slider').value));
      });
      document.getElementById('scenario-slider').addEventListener('input', (e) => {
        const value = Number(e.target.value);
        if (value < 30) {
          scenarioNote.textContent = 'Low displacement, gradual productivity gains, minimal policy urgency.';
        } else if (value < 70) {
          scenarioNote.textContent = 'Moderate displacement, steady productivity gains, mixed policy pressure.';
        } else {
          scenarioNote.textContent = 'High displacement, rapid productivity gains, urgent policy response.';
        }
        drawScenario(value);
      });

      const artifactNote = document.getElementById('artifact-note');
      document.querySelectorAll('.artifact-card').forEach(card => {
        card.addEventListener('click', () => {
          artifactNote.textContent = card.dataset.note;
        });
      });

      const matrixDetail = document.getElementById('matrix-detail');
      document.querySelectorAll('.matrix-cell').forEach(cell => {
        cell.addEventListener('click', () => {
          document.querySelectorAll('.matrix-cell').forEach(item => item.classList.remove('active'));
          cell.classList.add('active');
          matrixDetail.textContent = cell.dataset.detail;
        });
      });
    });
  </script>
</body>
</html>
