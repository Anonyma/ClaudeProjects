<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Learning Lab — Dynamic Modules</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@500;700&family=Space+Grotesk:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0f1115;
      --surface: #151922;
      --surface-2: #1c2230;
      --ink: #f4f4f2;
      --muted: #9aa0ac;
      --accent: #ffb347;
      --accent-2: #7bdff2;
      --accent-3: #b8f2e6;
      --border: rgba(244, 244, 242, 0.08);
      --shadow: 0 22px 60px rgba(0, 0, 0, 0.45);
      --radius: 18px;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: radial-gradient(circle at 15% 20%, rgba(123, 223, 242, 0.2), transparent 40%),
                  radial-gradient(circle at 70% 20%, rgba(255, 179, 71, 0.15), transparent 45%),
                  var(--bg);
      color: var(--ink);
      font-family: "Space Grotesk", sans-serif;
    }

    .wrap {
      max-width: 1200px;
      margin: 0 auto;
      padding: 32px 24px 72px;
    }

    header {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 18px;
      justify-content: space-between;
      margin-bottom: 28px;
    }

    h1 {
      font-family: "Fraunces", serif;
      font-size: clamp(2rem, 3vw, 3rem);
      margin: 0;
    }

    .subtitle {
      color: var(--muted);
      max-width: 520px;
      font-size: 0.98rem;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
    }

    .panel {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.02), transparent 60%),
                  var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 18px;
      box-shadow: var(--shadow);
      min-height: 260px;
      position: relative;
      overflow: hidden;
    }

    .panel h2 {
      margin: 0 0 8px;
      font-size: 1.05rem;
    }

    .panel p {
      margin: 0 0 12px;
      color: var(--muted);
      font-size: 0.9rem;
    }

    .graph-detail {
      background: var(--surface-2);
      border-radius: 14px;
      border: 1px solid var(--border);
      padding: 12px;
      margin-top: 10px;
    }

    .graph-title {
      font-weight: 600;
      font-size: 0.9rem;
    }

    .graph-meta {
      color: var(--muted);
      font-size: 0.8rem;
      margin-top: 6px;
      line-height: 1.4;
    }

    .graph-tags {
      margin-top: 8px;
      font-size: 0.7rem;
      color: var(--muted);
    }

    .graph-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    .graph-chip {
      border-radius: 999px;
      border: 1px solid var(--border);
      background: transparent;
      color: var(--muted);
      padding: 6px 12px;
      font-size: 0.7rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      cursor: pointer;
    }

    .graph-chip.active {
      border-color: var(--accent-2);
      color: var(--accent-2);
    }

    .orbit {
      position: relative;
      height: 220px;
      margin-top: 10px;
    }

    .orbit-ring {
      position: absolute;
      inset: 10% 18% 10% 18%;
      border: 1px dashed rgba(123, 223, 242, 0.4);
      border-radius: 50%;
    }

    .orbit-ring.r2 {
      inset: 22% 30% 22% 30%;
      border-color: rgba(255, 179, 71, 0.4);
    }

    .orbit-event {
      position: absolute;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--accent-2);
      box-shadow: 0 0 12px rgba(123, 223, 242, 0.8);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .orbit-event:hover {
      transform: scale(1.3);
    }

    .orbit-event.active {
      transform: scale(1.4);
      background: var(--accent);
      box-shadow: 0 0 16px rgba(255, 179, 71, 0.8);
    }

    .orbit-card {
      position: absolute;
      right: 10px;
      bottom: 10px;
      background: var(--surface-2);
      border-radius: 12px;
      padding: 10px 12px;
      font-size: 0.8rem;
      color: var(--muted);
      border: 1px solid var(--border);
    }

    .orbit-title {
      font-weight: 600;
      color: var(--ink);
      margin-bottom: 4px;
    }

    .orbit-detail {
      font-size: 0.75rem;
      color: var(--muted);
      line-height: 1.4;
    }

    .slider-wrap {
      margin-top: 12px;
    }

    input[type="range"] {
      width: 100%;
      accent-color: var(--accent);
    }

    .scenario-legend {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      font-size: 0.7rem;
      color: var(--muted);
      margin-top: 6px;
    }

    .scenario-legend span::before {
      content: "";
      display: inline-block;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      margin-right: 6px;
      background: currentColor;
    }

    .legend-displacement {
      color: var(--accent);
    }

    .legend-productivity {
      color: var(--accent-2);
    }

    .scenario-output {
      margin-top: 10px;
      background: var(--surface-2);
      border-radius: 12px;
      border: 1px solid var(--border);
      padding: 10px 12px;
      display: grid;
      gap: 6px;
      font-size: 0.8rem;
      color: var(--muted);
    }

    .scenario-line span {
      color: var(--ink);
      font-weight: 600;
      margin-right: 6px;
    }

    .split-lens {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .lens-card {
      background: var(--surface-2);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px;
      min-height: 140px;
      transition: transform 0.2s ease, border 0.2s ease, box-shadow 0.2s ease;
    }

    .lens-card h3 {
      margin: 0 0 8px;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--accent-2);
    }

    .lens-card.active {
      border-color: rgba(123, 223, 242, 0.6);
      box-shadow: 0 0 24px rgba(123, 223, 242, 0.25);
      transform: translateY(-2px);
    }

    .lens-body {
      font-size: 0.85rem;
      color: var(--muted);
      margin-bottom: 10px;
    }

    .lens-metrics {
      display: grid;
      gap: 8px;
      font-size: 0.7rem;
      color: var(--muted);
    }

    .metric-row {
      display: grid;
      grid-template-columns: 80px 1fr;
      gap: 8px;
      align-items: center;
    }

    .metric-bar {
      height: 6px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.1);
      overflow: hidden;
    }

    .metric-bar span {
      display: block;
      height: 100%;
      border-radius: inherit;
      background: linear-gradient(90deg, var(--accent-2), var(--accent));
    }

    .lens-summary {
      margin-top: 10px;
      font-size: 0.82rem;
      color: var(--muted);
      background: rgba(255, 255, 255, 0.02);
      border-radius: 10px;
      padding: 8px 10px;
      border: 1px solid var(--border);
    }

    .contrast-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 10px;
    }

    .contrast-chip {
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: transparent;
      color: var(--muted);
      font-size: 0.72rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      cursor: pointer;
    }

    .contrast-chip.active {
      border-color: var(--accent);
      color: var(--accent);
      background: rgba(255, 179, 71, 0.1);
    }

    .accordion {
      display: grid;
      gap: 8px;
    }

    .accordion button {
      width: 100%;
      text-align: left;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--surface-2);
      color: var(--ink);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .accordion button::after {
      content: "+";
      color: var(--muted);
      font-weight: 600;
    }

    .accordion button[aria-expanded="true"]::after {
      content: "–";
      color: var(--accent-2);
    }

    .accordion .content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      background: rgba(123, 223, 242, 0.08);
      border-radius: 12px;
      padding: 0 12px;
      color: var(--muted);
    }

    .accordion .content.open {
      max-height: 120px;
      padding: 10px 12px;
    }

    .artifact-carousel {
      display: grid;
      grid-auto-flow: column;
      grid-auto-columns: minmax(160px, 1fr);
      gap: 10px;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      padding-bottom: 6px;
    }

    .artifact-card {
      scroll-snap-align: start;
      border-radius: 14px;
      padding: 10px;
      background: var(--surface-2);
      border: 1px solid var(--border);
      min-height: 140px;
      cursor: pointer;
      transition: transform 0.2s ease, border 0.2s ease;
    }

    .artifact-card:hover {
      transform: translateY(-3px);
      border-color: rgba(255, 179, 71, 0.5);
    }

    .artifact-card.active {
      border-color: rgba(255, 179, 71, 0.8);
    }

    .artifact-thumb {
      height: 70px;
      border-radius: 12px;
      background: linear-gradient(135deg, rgba(255, 179, 71, 0.25), rgba(123, 223, 242, 0.25));
      margin-bottom: 8px;
    }

    .artifact-title {
      font-size: 0.8rem;
      font-weight: 600;
    }

    .artifact-note {
      margin-top: 10px;
      font-size: 0.8rem;
      color: var(--muted);
    }

    .artifact-preview {
      margin-top: 10px;
      border-radius: 14px;
      overflow: hidden;
      border: 1px solid var(--border);
      background: var(--surface-2);
    }

    .artifact-preview img {
      width: 100%;
      height: 140px;
      object-fit: cover;
      display: block;
    }

    .artifact-caption {
      padding: 8px 10px;
      font-size: 0.78rem;
      color: var(--muted);
    }

    .heatmap-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 6px;
      margin-top: 10px;
    }

    .heatmap-cell {
      border-radius: 8px;
      padding: 8px;
      font-size: 0.7rem;
      text-align: center;
      color: var(--ink);
      background: rgba(123, 223, 242, 0.2);
    }

    .heatmap-cell.high { background: rgba(123, 223, 242, 0.35); }
    .heatmap-cell.mid { background: rgba(255, 179, 71, 0.25); }
    .heatmap-cell.low { background: rgba(255, 255, 255, 0.06); }

    .heatmap-cell.active {
      outline: 2px solid rgba(255, 179, 71, 0.5);
      color: var(--ink);
    }

    .heatmap-detail {
      margin-top: 10px;
      font-size: 0.8rem;
      color: var(--muted);
    }

    .concept-matrix {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
      margin-top: 12px;
    }

    .matrix-cell {
      background: var(--surface-2);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px;
      min-height: 72px;
      font-size: 0.78rem;
      color: var(--muted);
      cursor: pointer;
      transition: border 0.2s ease, color 0.2s ease;
    }

    .matrix-cell.active {
      border-color: rgba(123, 223, 242, 0.6);
      color: var(--ink);
    }

    .matrix-detail {
      margin-top: 10px;
      font-size: 0.8rem;
      color: var(--muted);
    }

    .orbit-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 8px;
      font-size: 0.78rem;
      color: var(--muted);
    }

    .orbit-chip {
      padding: 6px 10px;
      border-radius: 10px;
      border: 1px solid var(--border);
      cursor: pointer;
      background: rgba(255, 255, 255, 0.02);
    }

    .orbit-chip.active {
      border-color: var(--accent-2);
      color: var(--accent-2);
    }

    .scenario-note {
      margin-top: 10px;
      font-size: 0.85rem;
      color: var(--muted);
    }

    @media (max-width: 900px) {
      .split-lens {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Learning Lab — Dynamic Modules</h1>
        <div class="subtitle">A darker, more cinematic visual language with interactive modules designed for quick comprehension and exploration.</div>
      </div>
      <div class="subtitle">Prototype only — pick what feels right, then we’ll integrate.</div>
    </header>

    <div class="grid">
      <section class="panel">
        <h2>Constellation Graph</h2>
        <p>WebGL graph with subtle glow + clustering. Hover nodes to highlight a concept cluster.</p>
        <div id="sigma" style="height:200px;"></div>
        <div class="graph-detail" id="graph-detail">
          <div class="graph-title" id="graph-title">Parametricism</div>
          <div class="graph-meta" id="graph-meta">Zaha Hadid’s MAXXI and Heydar Aliyev Center use algorithmic surfaces to choreograph movement.</div>
          <div class="graph-tags" id="graph-tags">Architects: Zaha Hadid • Tools: Rhino/Grasshopper • Era: 2000s</div>
        </div>
        <div class="graph-chips" id="graph-chips">
          <button class="graph-chip active" data-node="param">Parametricism</button>
          <button class="graph-chip" data-node="bio">Biomimicry</button>
          <button class="graph-chip" data-node="timber">Mass Timber</button>
          <button class="graph-chip" data-node="ai">AI Tools</button>
          <button class="graph-chip" data-node="kinetic">Kinetic Facades</button>
        </div>
      </section>

      <section class="panel">
        <h2>Orbit Timeline</h2>
        <p>Key turning points mapped onto orbital rings. Click nodes to update the detail card.</p>
        <div class="orbit" id="orbit">
          <div class="orbit-ring"></div>
          <div class="orbit-ring r2"></div>
          <div class="orbit-card" id="orbit-card">
            <div class="orbit-title" id="orbit-title">1997 — Guggenheim Bilbao</div>
            <div class="orbit-detail" id="orbit-detail">Iconic form making + tourism-led urban revival.</div>
          </div>
        </div>
        <div class="orbit-list" id="orbit-list">
          <div class="orbit-chip" data-label="1988 — MoMA Deconstructivism" data-detail="Fractured geometries challenge modernist order.">1988 — MoMA Deconstructivism</div>
          <div class="orbit-chip active" data-label="1997 — Guggenheim Bilbao" data-detail="Iconic form making + tourism-led urban revival.">1997 — Guggenheim Bilbao</div>
          <div class="orbit-chip" data-label="2008 — Parametricism Manifesto" data-detail="Computational workflows become a movement.">2008 — Parametricism Manifesto</div>
          <div class="orbit-chip" data-label="2013 — Living Building Challenge" data-detail="Regenerative targets shift sustainability.">2013 — Living Building Challenge</div>
          <div class="orbit-chip" data-label="2017 — Mass Timber Surge" data-detail="CLT unlocks mid-rise carbon reductions.">2017 — Mass Timber Surge</div>
        </div>
      </section>

      <section class="panel">
        <h2>Scenario Slider</h2>
        <p>Drag to see how automation intensity reshapes the learning summary.</p>
        <canvas id="scenario-canvas" height="140" style="width:100%;"></canvas>
        <div class="slider-wrap">
          <input id="scenario-slider" type="range" min="0" max="100" value="42" />
        </div>
        <div class="scenario-legend">
          <span class="legend-displacement">Displacement</span>
          <span class="legend-productivity">Productivity</span>
        </div>
        <div class="scenario-output" id="scenario-output">
          <div class="scenario-line"><span>Focus shift:</span> Digital craft + parametric workflows</div>
          <div class="scenario-line"><span>Case anchor:</span> BMW Leipzig robotics + adaptive tooling</div>
          <div class="scenario-line"><span>Assessment:</span> Design a workflow that preserves human authorship</div>
        </div>
        <div class="scenario-note" id="scenario-note">Moderate displacement, steady productivity gains, mixed policy pressure.</div>
      </section>

      <section class="panel">
        <h2>Split Lens Compare</h2>
        <p>Toggle the lens to shift the contrast emphasis.</p>
        <div class="contrast-controls" id="contrast-controls">
          <button class="contrast-chip active" data-lens="aesthetic">Aesthetic</button>
          <button class="contrast-chip" data-lens="politics">Politics</button>
          <button class="contrast-chip" data-lens="material">Material</button>
        </div>
        <div class="split-lens">
          <div class="lens-card active" id="lens-left">
            <h3>Rococo</h3>
            <div class="lens-body">Pastel palette, intimacy, ornamental lightness, private pleasure.</div>
            <div class="lens-metrics" id="lens-left-metrics"></div>
          </div>
          <div class="lens-card" id="lens-right">
            <h3>Brutalism</h3>
            <div class="lens-body">Raw structure, moral clarity, collective function, heavy mass.</div>
            <div class="lens-metrics" id="lens-right-metrics"></div>
          </div>
        </div>
        <div class="lens-summary" id="lens-summary">Contrast reads as ornament vs structure, where social intent flips from private pleasure to civic duty.</div>
      </section>

      <section class="panel">
        <h2>Evidence Stack</h2>
        <p>Click to unfold claims + sources without leaving the page.</p>
        <div class="accordion">
          <button data-acc="1" aria-expanded="false" aria-controls="acc-1">Claim: Parametricism responds to urban flows</button>
          <div class="content" id="acc-1">MAXXI, ZHA masterplans, and flow-based circulation studies support this claim.</div>
          <button data-acc="2" aria-expanded="false" aria-controls="acc-2">Claim: Mass timber reduces embodied carbon</button>
          <div class="content" id="acc-2">Brock Commons, Mjostarnet, and CLT lifecycle studies show large carbon reductions.</div>
          <button data-acc="3" aria-expanded="false" aria-controls="acc-3">Claim: Kinetic facades reduce heat gain</button>
          <div class="content" id="acc-3">Al Bahar Towers report ~50% solar gain reduction via responsive mashrabiya.</div>
        </div>
      </section>

      <section class="panel">
        <h2>Story Heatmap</h2>
        <p>Micro heatmap to show which sections learners revisit most.</p>
        <div class="heatmap-grid">
          <div class="heatmap-cell high" data-detail="Intro spikes when learners revisit the definition of parametricism.">Intro</div>
          <div class="heatmap-cell mid" data-detail="Core theory gets steady revisits for vocabulary refresh.">Core</div>
          <div class="heatmap-cell low" data-detail="Case studies are skimmed quickly in week one.">Cases</div>
          <div class="heatmap-cell mid" data-detail="Wrap-up is revisited before quizzes.">Wrap</div>
          <div class="heatmap-cell low" data-detail="Week 1 is largely for orientation and baseline context.">Week 1</div>
          <div class="heatmap-cell high" data-detail="Week 2 is revisited for the MAXXI + Bilbao case comparisons.">Week 2</div>
          <div class="heatmap-cell mid" data-detail="Week 3 sits in the middle for material innovation references.">Week 3</div>
          <div class="heatmap-cell low" data-detail="Week 4 is a quick skim for synthesis.">Week 4</div>
        </div>
        <div class="heatmap-detail" id="heatmap-detail">Intro spikes when learners revisit the definition of parametricism.</div>
      </section>

      <section class="panel">
        <h2>Artifact Carousel</h2>
        <p>Swipe through iconic objects; tap to reveal the key annotation.</p>
        <div class="artifact-carousel" id="artifact-carousel">
          <div class="artifact-card active" data-note="Olbrich’s Secession Building becomes the movement’s architectural logo." data-image="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6d/Wien_Secessionsgebaeude.jpg/320px-Wien_Secessionsgebaeude.jpg" data-caption="Vienna Secession Building (1898) — Josef Maria Olbrich">
            <div class="artifact-thumb">
              <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6d/Wien_Secessionsgebaeude.jpg/320px-Wien_Secessionsgebaeude.jpg" alt="Vienna Secession Building" loading="lazy">
            </div>
            <div class="artifact-title">Vienna Secession</div>
          </div>
          <div class="artifact-card" data-note="Tiffany’s glass elevates industrial craft into luminous art." data-image="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8f/Tiffany_lamp.jpg/320px-Tiffany_lamp.jpg" data-caption="Tiffany lamp (c. 1900) — decorative arts at scale">
            <div class="artifact-thumb">
              <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8f/Tiffany_lamp.jpg/320px-Tiffany_lamp.jpg" alt="Tiffany lamp" loading="lazy">
            </div>
            <div class="artifact-title">Tiffany Lamp</div>
          </div>
          <div class="artifact-card" data-note="Horta’s staircases show total design down to railings and light." data-image="https://upload.wikimedia.org/wikipedia/commons/thumb/5/57/Horta_Stoclet_staircase.jpg/320px-Horta_Stoclet_staircase.jpg" data-caption="Horta staircase — Belgian Art Nouveau interior">
            <div class="artifact-thumb">
              <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/57/Horta_Stoclet_staircase.jpg/320px-Horta_Stoclet_staircase.jpg" alt="Horta staircase" loading="lazy">
            </div>
            <div class="artifact-title">Horta Staircase</div>
          </div>
          <div class="artifact-card" data-note="Bilbao’s titanium skin foreshadows computational surface logic." data-image="https://upload.wikimedia.org/wikipedia/commons/thumb/0/06/Guggenheim_Museum_Bilbao_2018.jpg/320px-Guggenheim_Museum_Bilbao_2018.jpg" data-caption="Guggenheim Bilbao (1997) — Gehry’s digital turn">
            <div class="artifact-thumb">
              <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/06/Guggenheim_Museum_Bilbao_2018.jpg/320px-Guggenheim_Museum_Bilbao_2018.jpg" alt="Guggenheim Museum Bilbao" loading="lazy">
            </div>
            <div class="artifact-title">Guggenheim Bilbao</div>
          </div>
        </div>
        <div class="artifact-preview" id="artifact-preview">
          <img id="artifact-image" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6d/Wien_Secessionsgebaeude.jpg/320px-Wien_Secessionsgebaeude.jpg" alt="Vienna Secession Building">
          <div class="artifact-caption" id="artifact-caption">Vienna Secession Building (1898) — Josef Maria Olbrich</div>
        </div>
        <div class="artifact-note" id="artifact-note">Olbrich’s Secession Building becomes the movement’s architectural logo.</div>
      </section>

      <section class="panel">
        <h2>Concept Matrix</h2>
        <p>Plot ideas across axes to compare tone, politics, and material logic.</p>
        <div class="concept-matrix" id="concept-matrix">
          <div class="matrix-cell active" data-detail="Ornament + private luxury: Rococo interiors, salon culture, soft authority.">Ornament + Private</div>
          <div class="matrix-cell" data-detail="Ornament + public spectacle: Secession exhibitions and civic pageantry.">Ornament + Public</div>
          <div class="matrix-cell" data-detail="Austere + public: Brutalist civic housing and collective infrastructures.">Austere + Public</div>
          <div class="matrix-cell" data-detail="Austere + private: Minimalist domestic calm, engineered restraint.">Austere + Private</div>
        </div>
        <div class="matrix-detail" id="matrix-detail">Ornament + private luxury: Rococo interiors, salon culture, soft authority.</div>
      </section>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/graphology@0.25.1/dist/graphology.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sigma@2.4.0/build/sigma.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const graphDetails = {
        param: {
          title: 'Parametricism',
          meta: 'Zaha Hadid’s MAXXI and Heydar Aliyev Center use algorithmic surfaces to choreograph movement.',
          tags: 'Architects: Zaha Hadid • Tools: Rhino/Grasshopper • Era: 2000s',
        },
        bio: {
          title: 'Biomimicry',
          meta: 'Eastgate Centre and Eden Project translate biological logic into passive systems.',
          tags: 'Focus: ecosystems • Strategy: passive cooling • Era: 1990s–2010s',
        },
        timber: {
          title: 'Mass Timber',
          meta: 'Brock Commons proves tall timber can scale while cutting embodied carbon.',
          tags: 'Material: CLT • Case: Brock Commons • Era: 2010s',
        },
        ai: {
          title: 'AI Tools',
          meta: 'Generative design from Autodesk + Spacemaker shifts early-stage massing decisions.',
          tags: 'Workflow: generative options • Risk: homogeneity • Era: 2020s',
        },
        kinetic: {
          title: 'Kinetic Facades',
          meta: 'Al Bahar Towers show responsive shading that cuts solar gain.',
          tags: 'System: mashrabiya • Impact: energy control • Era: 2010s',
        },
      };
      const graphTitle = document.getElementById('graph-title');
      const graphMeta = document.getElementById('graph-meta');
      const graphTags = document.getElementById('graph-tags');
      const graphChips = document.querySelectorAll('.graph-chip');
      const setGraphDetail = (id) => {
        const detail = graphDetails[id];
        if (!detail) return;
        graphTitle.textContent = detail.title;
        graphMeta.textContent = detail.meta;
        graphTags.textContent = detail.tags;
        graphChips.forEach(chip => chip.classList.toggle('active', chip.dataset.node === id));
      };
      graphChips.forEach(chip => {
        chip.addEventListener('click', () => {
          setGraphDetail(chip.dataset.node);
        });
      });
      setGraphDetail('param');

      if (window.graphology && window.sigma) {
        const Graph = graphology.Graph;
        const graph = new Graph();
        const nodes = [
          { id: 'param', label: 'Parametricism', x: 0, y: 0, size: 12, color: '#7bdff2' },
          { id: 'bio', label: 'Biomimicry', x: 1, y: 1, size: 10, color: '#b8f2e6' },
          { id: 'timber', label: 'Mass Timber', x: -1, y: 1, size: 10, color: '#ffb347' },
          { id: 'ai', label: 'AI Tools', x: 1, y: -1, size: 8, color: '#f4978e' },
          { id: 'kinetic', label: 'Kinetic Facades', x: -1, y: -1, size: 8, color: '#ffd6a5' },
        ];
        nodes.forEach(node => graph.addNode(node.id, node));
        graph.addEdge('param', 'bio');
        graph.addEdge('param', 'ai');
        graph.addEdge('bio', 'timber');
        graph.addEdge('timber', 'kinetic');

        const renderer = new sigma.Sigma(graph, document.getElementById('sigma'), {
          defaultEdgeColor: 'rgba(255,255,255,0.25)',
          defaultNodeColor: '#7bdff2',
          renderLabels: true,
          labelFont: 'Space Grotesk',
          labelColor: { color: '#f4f4f2' },
        });
        renderer.on('enterNode', ({ node }) => setGraphDetail(node));
        renderer.on('clickNode', ({ node }) => setGraphDetail(node));
      } else {
        document.getElementById('sigma').textContent = 'Graph unavailable (library not loaded).';
      }

      const orbitEvents = [
        { label: '1988 — MoMA Deconstructivism', detail: 'Fractured geometries challenge modernist order.', x: '18%', y: '18%' },
        { label: '1997 — Guggenheim Bilbao', detail: 'Iconic form making + tourism-led urban revival.', x: '76%', y: '28%' },
        { label: '2008 — Parametricism Manifesto', detail: 'Computational workflows become a movement.', x: '30%', y: '78%' },
        { label: '2013 — Living Building Challenge', detail: 'Regenerative targets shift sustainability.', x: '50%', y: '50%' },
        { label: '2017 — Mass Timber Surge', detail: 'CLT unlocks mid-rise carbon reductions.', x: '70%', y: '70%' },
      ];
      const orbit = document.getElementById('orbit');
      const cardTitle = document.getElementById('orbit-title');
      const cardDetail = document.getElementById('orbit-detail');
      const orbitDots = new Map();
      const setOrbitCard = (event) => {
        cardTitle.textContent = event.label;
        cardDetail.textContent = event.detail;
        orbitDots.forEach((dot, label) => {
          dot.classList.toggle('active', label === event.label);
        });
        document.querySelectorAll('.orbit-chip').forEach(chip => {
          chip.classList.toggle('active', chip.dataset.label === event.label);
        });
      };
      orbitEvents.forEach(event => {
        const dot = document.createElement('div');
        dot.className = 'orbit-event';
        dot.style.left = event.x;
        dot.style.top = event.y;
        dot.dataset.label = event.label;
        orbitDots.set(event.label, dot);
        dot.addEventListener('mouseenter', () => { setOrbitCard(event); });
        dot.addEventListener('click', () => { setOrbitCard(event); });
        orbit.appendChild(dot);
      });

      document.querySelectorAll('.orbit-chip').forEach(chip => {
        chip.addEventListener('click', () => {
          document.querySelectorAll('.orbit-chip').forEach(c => c.classList.remove('active'));
          chip.classList.add('active');
          setOrbitCard({ label: chip.dataset.label, detail: chip.dataset.detail });
        });
      });
      setOrbitCard(orbitEvents[1]);

      const lensData = {
        aesthetic: {
          left: 'Pastel palette, intimacy, ornamental lightness, private pleasure.',
          right: 'Raw structure, moral clarity, collective function, heavy mass.',
          summary: 'Contrast reads as ornament vs structure, where social intent flips from private pleasure to civic duty.',
          metrics: [
            { label: 'Ornament', left: 88, right: 22 },
            { label: 'Lightness', left: 75, right: 30 },
            { label: 'Expression', left: 68, right: 40 },
          ],
        },
        politics: {
          left: 'Signals aristocratic leisure and private privilege.',
          right: 'Signals collective infrastructure and state power.',
          summary: 'Privilege vs collectivism shifts who the architecture is meant to serve.',
          metrics: [
            { label: 'Hierarchy', left: 78, right: 35 },
            { label: 'Collective', left: 20, right: 85 },
            { label: 'Control', left: 42, right: 70 },
          ],
        },
        material: {
          left: 'Gilded surfaces, carved ornament, delicate craft.',
          right: 'Raw concrete, modular repetition, industrial scale.',
          summary: 'Crafted surface becomes exposed structure as material honesty rises.',
          metrics: [
            { label: 'Surface', left: 86, right: 28 },
            { label: 'Mass', left: 25, right: 90 },
            { label: 'Craft', left: 70, right: 38 },
          ],
        },
      };

      const lensLeft = document.getElementById('lens-left');
      const lensRight = document.getElementById('lens-right');
      const lensLeftMetrics = document.getElementById('lens-left-metrics');
      const lensRightMetrics = document.getElementById('lens-right-metrics');
      const lensSummary = document.getElementById('lens-summary');
      const renderMetrics = (lens) => {
        const metrics = lensData[lens].metrics;
        lensLeftMetrics.innerHTML = metrics.map(metric => (
          `<div class="metric-row"><div>${metric.label}</div><div class="metric-bar"><span style="width:${metric.left}%"></span></div></div>`
        )).join('');
        lensRightMetrics.innerHTML = metrics.map(metric => (
          `<div class="metric-row"><div>${metric.label}</div><div class="metric-bar"><span style="width:${metric.right}%"></span></div></div>`
        )).join('');
        lensSummary.textContent = lensData[lens].summary;
      };
      renderMetrics('aesthetic');
      document.getElementById('contrast-controls').addEventListener('click', (e) => {
        const target = e.target.closest('.contrast-chip');
        if (!target) return;
        document.querySelectorAll('.contrast-chip').forEach(chip => chip.classList.remove('active'));
        target.classList.add('active');
        const lens = target.dataset.lens;
        lensLeft.classList.add('active');
        lensRight.classList.add('active');
        lensLeft.querySelector('.lens-body').textContent = lensData[lens].left;
        lensRight.querySelector('.lens-body').textContent = lensData[lens].right;
        renderMetrics(lens);
      });

      const accordionButtons = document.querySelectorAll('.accordion button');
      accordionButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          const content = document.getElementById(`acc-${btn.dataset.acc}`);
          const isOpen = btn.getAttribute('aria-expanded') === 'true';
          accordionButtons.forEach(other => {
            const otherContent = document.getElementById(`acc-${other.dataset.acc}`);
            other.setAttribute('aria-expanded', 'false');
            otherContent.classList.remove('open');
          });
          if (!isOpen) {
            btn.setAttribute('aria-expanded', 'true');
            content.classList.add('open');
          }
        });
      });

      const scenarioNote = document.getElementById('scenario-note');
      const scenarioCanvas = document.getElementById('scenario-canvas');
      const scenarioCtx = scenarioCanvas.getContext('2d');
      const scenarioHeight = scenarioCanvas.height;
      const scenarioOutput = document.getElementById('scenario-output');
      const scenarioData = {
        low: {
          focus: 'Handcraft + conservation skills',
          anchor: 'Vienna Secession workshop model',
          assessment: 'Identify which tasks must remain human-led',
        },
        mid: {
          focus: 'Digital craft + parametric workflows',
          anchor: 'BMW Leipzig robotics + adaptive tooling',
          assessment: 'Design a workflow that preserves human authorship',
        },
        high: {
          focus: 'Policy, ethics, and labor transition',
          anchor: 'Amazon warehouse automation debates',
          assessment: 'Write a mitigation plan for displacement pressure',
        },
      };
      const renderScenarioOutput = (value) => {
        const bucket = value < 30 ? scenarioData.low : value < 70 ? scenarioData.mid : scenarioData.high;
        scenarioOutput.innerHTML = `
          <div class="scenario-line"><span>Focus shift:</span> ${bucket.focus}</div>
          <div class="scenario-line"><span>Case anchor:</span> ${bucket.anchor}</div>
          <div class="scenario-line"><span>Assessment:</span> ${bucket.assessment}</div>
        `;
      };
      const resizeScenario = () => {
        const dpr = window.devicePixelRatio || 1;
        const displayWidth = scenarioCanvas.clientWidth;
        const displayHeight = scenarioHeight;
        scenarioCanvas.width = displayWidth * dpr;
        scenarioCanvas.height = displayHeight * dpr;
        scenarioCtx.setTransform(dpr, 0, 0, dpr, 0, 0);
      };
      const drawScenario = (value) => {
        const width = scenarioCanvas.clientWidth;
        const height = scenarioHeight;
        scenarioCtx.clearRect(0, 0, width, height);
        scenarioCtx.strokeStyle = 'rgba(244,244,242,0.1)';
        scenarioCtx.beginPath();
        scenarioCtx.moveTo(0, height - 24);
        scenarioCtx.lineTo(width, height - 24);
        scenarioCtx.stroke();

        const displacement = value;
        const productivity = Math.min(100, 30 + value * 0.6);
        const xStep = width / 4;
        const points = [0, value * 0.4, value * 0.7, displacement];

        scenarioCtx.strokeStyle = '#ffb347';
        scenarioCtx.lineWidth = 2;
        scenarioCtx.beginPath();
        points.forEach((point, index) => {
          const x = index * xStep;
          const y = height - 24 - (point / 100) * (height - 40);
          if (index === 0) {
            scenarioCtx.moveTo(x, y);
          } else {
            scenarioCtx.lineTo(x, y);
          }
        });
        scenarioCtx.stroke();

        scenarioCtx.strokeStyle = '#7bdff2';
        scenarioCtx.beginPath();
        const prodPoints = [20, productivity * 0.5, productivity * 0.8, productivity];
        prodPoints.forEach((point, index) => {
          const x = index * xStep;
          const y = height - 24 - (point / 100) * (height - 40);
          if (index === 0) {
            scenarioCtx.moveTo(x, y);
          } else {
            scenarioCtx.lineTo(x, y);
          }
        });
        scenarioCtx.stroke();
      };
      resizeScenario();
      renderScenarioOutput(Number(document.getElementById('scenario-slider').value));
      drawScenario(Number(document.getElementById('scenario-slider').value));
      window.addEventListener('resize', () => {
        resizeScenario();
        drawScenario(Number(document.getElementById('scenario-slider').value));
      });
      document.getElementById('scenario-slider').addEventListener('input', (e) => {
        const value = Number(e.target.value);
        if (value < 30) {
          scenarioNote.textContent = 'Low displacement, gradual productivity gains, minimal policy urgency.';
        } else if (value < 70) {
          scenarioNote.textContent = 'Moderate displacement, steady productivity gains, mixed policy pressure.';
        } else {
          scenarioNote.textContent = 'High displacement, rapid productivity gains, urgent policy response.';
        }
        renderScenarioOutput(value);
        drawScenario(value);
      });

      const heatmapDetail = document.getElementById('heatmap-detail');
      const heatmapCells = document.querySelectorAll('.heatmap-cell');
      heatmapCells.forEach(cell => {
        cell.addEventListener('click', () => {
          heatmapCells.forEach(item => item.classList.remove('active'));
          cell.classList.add('active');
          heatmapDetail.textContent = cell.dataset.detail;
        });
      });
      if (heatmapCells.length) {
        heatmapCells[0].classList.add('active');
        heatmapDetail.textContent = heatmapCells[0].dataset.detail;
      }

      const artifactNote = document.getElementById('artifact-note');
      const artifactImage = document.getElementById('artifact-image');
      const artifactCaption = document.getElementById('artifact-caption');
      const artifactCards = document.querySelectorAll('.artifact-card');
      const setArtifact = (card) => {
        artifactCards.forEach(item => item.classList.remove('active'));
        card.classList.add('active');
        artifactNote.textContent = card.dataset.note;
        artifactImage.src = card.dataset.image;
        artifactImage.alt = card.querySelector('.artifact-title').textContent;
        artifactCaption.textContent = card.dataset.caption;
      };
      artifactCards.forEach(card => {
        card.addEventListener('click', () => {
          setArtifact(card);
        });
      });
      if (artifactCards.length) {
        setArtifact(artifactCards[0]);
      }

      const matrixDetail = document.getElementById('matrix-detail');
      document.querySelectorAll('.matrix-cell').forEach(cell => {
        cell.addEventListener('click', () => {
          document.querySelectorAll('.matrix-cell').forEach(item => item.classList.remove('active'));
          cell.classList.add('active');
          matrixDetail.textContent = cell.dataset.detail;
        });
      });
    });
  </script>
</body>
</html>
